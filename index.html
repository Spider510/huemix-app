<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>H√úMIX Einsatz</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f3f7f3;
    margin: 0;
    padding: 15px;
}
h1 {
    color: #2e7d32;
}
label {
    display: block;
    margin-top: 10px;
}
input, select, button {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
    font-size: 16px;
}
button {
    border: none;
    color: #fff;
    cursor: pointer;
}
.btn-save { background: #2e7d32; }
.btn-gps { background: #0277bd; }
#gpsStatus {
    margin-top: 10px;
    padding: 10px;
    background: #eee;
    font-size: 14px;
}
</style>
</head>

<body>

<h1>üå± H√úMIX Einsatz</h1>

<label>Name
<input id="name">
</label>

<label>Telefon
<input id="telefon">
</label>

<label>Stra√üe
<input id="strasse">
</label>

<label>Hausnummer
<input id="hausnr">
</label>

<label>PLZ
<input id="plz">
</label>

<label>Ort
<input id="ort">
</label>

<label>Rasen Spezial ‚Äì S√§cke (45 ‚Ç¨)
<input id="rasen" type="number" value="0">
</label>

<label>Bio-Volld√ºnger ‚Äì S√§cke (30 ‚Ç¨)
<input id="bio" type="number" value="0">
</label>

<label>Ausgestreut
<select id="ausgestreut">
    <option>Ja</option>
    <option>Nein</option>
</select>
</label>

<label>Zahlungsart
<select id="zahlung">
    <option>Bar</option>
    <option>EC</option>
</select>
</label>

<button class="btn-gps" onclick="holeGPS()">üìç GPS neu holen</button>

<div id="gpsStatus">GPS noch nicht ermittelt</div>

<button class="btn-save" onclick="speichern()">üíæ Speichern</button>

<script>
let lat = null;
let lon = null;

function holeGPS() {
    const status = document.getElementById("gpsStatus");
    status.textContent = "GPS wird ermittelt‚Ä¶";

    if (!navigator.geolocation) {
        status.textContent = "GPS nicht unterst√ºtzt";
        return;
    }

    navigator.geolocation.getCurrentPosition(
        pos => {
            lat = pos.coords.latitude;
            lon = pos.coords.longitude;
            status.textContent = 
                "GPS OK: " + lat.toFixed(6) + ", " + lon.toFixed(6);
        },
        err => {
            status.textContent = "GPS Fehler: " + err.message;
        },
        {
            enableHighAccuracy: true,
            timeout: 15000,
            maximumAge: 0
        }
    );
}

function speichern() {
    const datum = new Date().toLocaleString("de-DE", {
        hour: "2-digit",
        minute: "2-digit",
        day: "2-digit",
        month: "2-digit",
        year: "numeric"
    });

    const rasen = Number(document.getElementById("rasen").value);
    const bio = Number(document.getElementById("bio").value);

    const summe = rasen * 45 + bio * 30;

    const eintrag = {
        datum,
        name: name.value || "",
        telefon: telefon.value || "",
        strasse: strasse.value || "",
        hausnr: hausnr.value || "",
        plz: plz.value || "",
        ort: ort.value || "",
        rasen,
        bio,
        ausgestreut: ausgestreut.value,
        zahlung: zahlung.value,
        summe,
        lat,
        lon
    };

    let daten = JSON.parse(localStorage.getItem("huemix")) || [];
    daten.push(eintrag);
    localStorage.setItem("huemix", JSON.stringify(daten));

    alert("Gespeichert ‚úî");
}
</script>

</body>
</html>