<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>HÃœMIX Einsatz</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body { font-family: Arial, sans-serif; background:#f4f6f4; padding:15px; }
h1 { color:#2e7d32; }
label { display:block; margin-top:10px; }
input, select, button { width:100%; padding:8px; margin-top:4px; }
button { background:#2e7d32; color:#fff; border:none; margin-top:15px; font-size:16px; }
pre { background:#fff; padding:10px; margin-top:15px; white-space:pre-wrap; }
</style>
</head>

<body>

<h1>ğŸŒ± HÃœMIX Einsatz</h1>

<label>Name <input id="name"></label>
<label>Telefon <input id="telefon"></label>
<label>StraÃŸe <input id="strasse" placeholder="automatisch / manuell"></label>
<label>Hausnummer <input id="hausnummer"></label>
<label>Ort <input id="ort"></label>

<label>HÃœMIX Rasen Spezial â€“ SÃ¤cke
  <input id="rasen" type="number" value="0">
</label>

<label>HÃœMIX Bio-VolldÃ¼nger â€“ SÃ¤cke
  <input id="bio" type="number" value="0">
</label>

<label>Ausgestreut
  <select id="ausgestreut">
    <option>Ja</option>
    <option>Nein</option>
  </select>
</label>

<button onclick="speichern()">Speichern</button>

<pre id="ausgabe">ğŸ“¡ GPS wird ermitteltâ€¦</pre>

<script>
const f = id => document.getElementById(id);
let lat="", lon="";

navigator.geolocation.getCurrentPosition(pos => {
  lat = pos.coords.latitude;
  lon = pos.coords.longitude;

  f("ausgabe").textContent =
    "ğŸ“ GPS OK:\n" + lat.toFixed(6) + ", " + lon.toFixed(6) +
    "\n\nğŸ—ºï¸ Karte:\nhttps://maps.google.com/?q=" + lat + "," + lon;

  // Ortsname aus Koordinaten (fallback-sicher)
  fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&zoom=10`)
    .then(r => r.json())
    .then(d => {
      if (d.address) {
        f("ort").value =
          d.address.city ||
          d.address.town ||
          d.address.village ||
          d.address.county ||
          "";
      }
    })
    .catch(()=>{});
}, err => {
  f("ausgabe").textContent = "GPS-Fehler: " + err.message;
}, { enableHighAccuracy:true, timeout:10000 });

function speichern() {
  const jetzt = new Date().toLocaleString("de-DE");
  const maps = lat ? `https://maps.google.com/?q=${lat},${lon}` : "kein GPS";

  f("ausgabe").textContent = `
ğŸŒ± HÃœMIX Einsatz

ğŸ‘¤ Name: ${f("name").value}
ğŸ“ Telefon: ${f("telefon").value}

ğŸ“ Adresse:
${f("strasse").value} ${f("hausnummer").value}
${f("ort").value}

ğŸ§­ GPS:
${lat}, ${lon}

ğŸ—ºï¸ Karte:
${maps}

ğŸ•’ Datum/Zeit:
${jetzt}

ğŸ§´ DÃ¼nger:
- Rasen Spezial: ${f("rasen").value} SÃ¤cke
- Bio-VolldÃ¼nger: ${f("bio").value} SÃ¤cke

ğŸšœ Ausgestreut: ${f("ausgestreut").value}
`;
}
</script>

</body>
</html>